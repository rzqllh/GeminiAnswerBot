<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GeminiAnswerBot</title>
  <link rel="stylesheet" type="text/css" href="../assets/popup.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-title">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="header-icon">
          <path d="M12 2L14.472 9.528L22 12L14.472 14.472L12 22L9.528 14.472L2 12L9.528 9.528L12 2Z" stroke="currentColor" stroke-width="2.5" stroke-linejoin="round" />
        </svg>
        <span>GeminiAnswerBot</span>
      </div>
      <div class="header-actions">
        <button id="analyzePageButton" class="icon-button" title="Analyze Full Page">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 21.5A2.5 2.5 0 0 1 6.5 19H20a2 2 0 0 0 2-2V8.5A2.5 2.5 0 0 0 19.5 6H13A2.5 2.5 0 0 1 10.5 3.5H4a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2z"></path></svg>
        </button>
        <button id="rescanButton" class="icon-button" title="Rescan for Quiz">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6m-13 14v-6h6M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4" /></svg>
        </button>
        <button id="settingsButton" class="icon-button" title="Open Settings">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"><circle cx="12" cy="12" r="3" /><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83a2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33a1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2a2 2 0 0 1-2-2v-.09a1.65 1.65 0 0 0-1-1.51a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0a2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2a2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83a2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2a2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0a2 2 0 0 1 0 2.83l-.06-.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2a2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" /></svg>
        </button>
      </div>
    </header>

    <main id="mainContent" class="content-area">
      <div id="messageArea" class="hidden"></div>
      <div id="pageSummaryContainer" class="hidden"></div>

      <div id="quizModeContainer" class="main-panel">
        
        <div id="imagePreviewContainer" class="hidden">
          <div class="panel-header">
            <span class="panel-title-pill">Image Preview</span>
          </div>
          <div class="panel-content">
            <img id="imagePreview" src="" alt="Image Preview"/>
            <p id="imageStatusText">Processing image...</p>
          </div>
        </div>
        
        <div id="contentDisplayWrapper">
          <div class="panel-header">
            <span class="panel-title-pill">Analysis</span>
          </div>
          <div id="contentDisplay" class="panel-content"></div>
        </div>

        <div id="aiActionsWrapper" class="action-buttons-container hidden">
          <button id="explanationButton" class="action-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            Explanation
          </button>
        </div>
        
        <div id="answerContainer" class="hidden">
           <div class="panel-header">
             <span id="answerCardTitle" class="panel-title-pill">Answer</span>
             <div class="panel-header-action" id="copyAnswer" title="Copy Answer">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" /><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" /></svg>
             </div>
             <div class="panel-header-action" id="retryAnswer" title="Retry Answer">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6m-13 14v-6h6M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4" /></svg>
             </div>
           </div>
           <div id="answerDisplay" class="panel-content"></div>
           <div id="feedbackContainer" class="panel-footer hidden">
             <span class="footer-label">Is this answer correct?</span>
             <div class="feedback-buttons">
                <button id="feedbackCorrect" class="feedback-button" title="Correct">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/></svg>
                </button>
                <button id="feedbackIncorrect" class="feedback-button" title="Incorrect">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 15v7a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"/></svg>
                </button>
             </div>
          </div>
        </div>

        <div id="correctionPanel" class="hidden">
            <div class="panel-header">
                <span class="panel-title-pill">Select Correct Answer</span>
            </div>
            <div id="correctionOptions" class="panel-content"></div>
        </div>

        <div id="explanationContainer" class="hidden">
           <div class="panel-header">
             <span class="panel-title-pill">Explanation</span>
             <div class="panel-header-action" id="copyExplanation" title="Copy Explanation">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" /><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" /></svg>
             </div>
             <div class="panel-header-action" id="retryExplanation" title="Retry Explanation">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6m-13 14v-6h6M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4" /></svg>
             </div>
           </div>
           <div id="explanationDisplay" class="panel-content"></div>
        </div>
      </div>
    </main>
  </div>
  <script src="../js/vendor/dompurify.min.js"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/vendor/marked.min.js"></script> 
  <script src="../js/prompts.js"></script>
  <script src="../js/popup.js"></script>
</body>
</html>