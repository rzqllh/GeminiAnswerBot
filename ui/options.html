<!DOCTYPE html>
<html>
<head>
  <title>GeminiAnswerBot - Settings</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../assets/options.css">
</head>
<body>
  <div class="settings-container">
    <nav class="settings-sidebar">
      <ul>
        <li>
          <a href="#general" class="active">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg></span>
            General
          </a>
        </li>
        <li>
          <a href="#prompts">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg></span>
            Prompts
          </a>
        </li>
        <li>
          <a href="#history">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 4v6h6"></path><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg></span>
            History
          </a>
        </li>
        <li>
          <a href="#data">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg></span>
            Data
          </a>
        </li>
      </ul>
    </nav>

    <main class="settings-content">
      <section id="general" class="content-pane active">
        <h1>General</h1>
        <p class="section-description">Manage core settings for the extension and your API connection.</p>

        <fieldset>
            <legend>API & Model</legend>
            <div class="form-group">
                <label for="apiKey">API Key</label>
                <div class="input-wrapper">
                    <input type="password" id="apiKey" placeholder="Paste your Gemini API key here">
                    <span class="reveal-icon" id="revealApiKey" title="Show/Hide API Key">
                        <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        <svg class="icon-eye-slash hidden" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                    </span>
                </div>
            </div>
            <div class="form-group">
                <label for="modelSelect">AI Model</label>
                <select id="modelSelect">
                    <option value="gemini-1.5-flash-latest">Gemini 1.5 Flash (Fast & Efficient)</option>
                    <option value="gemini-1.5-pro-latest">Gemini 1.5 Pro (High Accuracy)</option>
                    <option value="gemini-1.0-pro">Gemini 1.0 Pro (Standard)</option>
                </select>
                <p class="form-hint">Choose the AI model to handle your requests.</p>
            </div>
        </fieldset>

        <fieldset>
            <legend>Behavior</legend>
            <div class="form-group">
                <label for="responseToneSelect">Response Style</label>
                <select id="responseToneSelect">
                    <option value="normal">Normal (Default)</option>
                    <option value="sederhana">Simple</option>
                    <option value="teknis">Technical & Detailed</option>
                    <option value="analogi">Use Analogies</option>
                </select>
                <p class="form-hint">Sets the AI's personality for all generated responses.</p>
            </div>
            <div class="form-group toggle-group">
                <label for="autoHighlightToggle">Quick Mode</label>
                <div class="toggle-wrapper">
                    <p class="form-hint">Automatically find the answer and highlight it on the page after scanning.</p>
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoHighlightToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="form-group toggle-group">
                <label for="preSubmissionCheckToggle">Pre-Submission Check</label>
                <div class="toggle-wrapper">
                    <p class="form-hint">Warn you if your selected quiz answer is different from the AI's suggestion.</p>
                    <label class="toggle-switch">
                        <input type="checkbox" id="preSubmissionCheckToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="temperatureSlider">Global AI Temperature</label>
                <div class="slider-container">
                    <span>More Factual</span>
                    <input type="range" id="temperatureSlider" min="0.0" max="1.0" step="0.1">
                    <span>More Creative</span>
                    <span id="temperatureValue" class="slider-value-display">0.4</span>
                </div>
                <p class="form-hint">This is the default temperature. You can override this for specific tasks in the "Prompts" tab.</p>
            </div>
        </fieldset>

        <div class="form-actions">
            <button id="testButton" class="button button-secondary">Test Connection</button>
            <button id="saveGeneralButton" class="button button-primary">Save Settings</button>
        </div>
      </section>

      <section id="prompts" class="content-pane">
        <h1>Prompts</h1>
        <p class="section-description">Customize system instructions for different tasks and manage your profiles.</p>
        <div class="profile-manager">
            <div class="form-group-inline">
                <label for="profileSelect">Active Profile</label>
                <select id="profileSelect"></select>
            </div>
            <div class="profile-actions">
                <button id="newProfileBtn" class="button button-secondary">New</button>
                <button id="renameProfileBtn" class="button button-secondary">Rename</button>
                <button id="deleteProfileBtn" class="button button-danger">Delete</button>
            </div>
        </div>

        <fieldset>
            <legend>Core Quiz Prompts</legend>
            <p class="fieldset-description">
                These prompts are used for the main quiz-solving functionality when you click the extension icon.
            </p>
            <div class="form-group">
                <label for="cleaningPrompt">Content Cleaning Prompt</label>
                <textarea id="cleaningPrompt" rows="5"></textarea>
            </div>
            <div class="form-group">
                <label for="answerPrompt">Answering Prompt</label>
                <textarea id="answerPrompt" rows="5"></textarea>
                <div class="temperature-control-group">
                    <label for="answer_temp_slider">Answering Temperature</label>
                    <div class="slider-container">
                        <span>Factual</span>
                        <input type="range" id="answer_temp_slider" class="prompt-temp-slider" data-target="answer_temp_value" min="0.0" max="1.0" step="0.1">
                        <span>Creative</span>
                        <span id="answer_temp_value" class="slider-value-display"></span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="explanationPrompt">Explanation Prompt</label>
                <textarea id="explanationPrompt" rows="5"></textarea>
                <div class="temperature-control-group">
                    <label for="explanation_temp_slider">Explanation Temperature</label>
                    <div class="slider-container">
                        <span>Factual</span>
                        <input type="range" id="explanation_temp_slider" class="prompt-temp-slider" data-target="explanation_temp_value" min="0.0" max="1.0" step="0.1">
                        <span>Creative</span>
                        <span id="explanation_temp_value" class="slider-value-display"></span>
                    </div>
                </div>
            </div>
        </fieldset>
        
        <fieldset>
            <legend>Context Menu & Toolbar Prompts</legend>
            <p class="fieldset-description">
                Used when you select text to summarize, translate, or rephrase.
            </p>
            <div class="form-group">
                <label for="summarizePrompt">Summarize Prompt</label>
                <textarea id="summarizePrompt" rows="5"></textarea>
                <div class="temperature-control-group">
                    <label for="summarize_temp_slider">Summarize Temperature</label>
                    <div class="slider-container">
                        <span>Factual</span>
                        <input type="range" id="summarize_temp_slider" class="prompt-temp-slider" data-target="summarize_temp_value" min="0.0" max="1.0" step="0.1">
                        <span>Creative</span>
                        <span id="summarize_temp_value" class="slider-value-display"></span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="translatePrompt">Translate Prompt</label>
                <textarea id="translatePrompt" rows="5"></textarea>
                <div class="temperature-control-group">
                    <label for="translate_temp_slider">Translate Temperature</label>
                    <div class="slider-container">
                        <span>Factual</span>
                        <input type="range" id="translate_temp_slider" class="prompt-temp-slider" data-target="translate_temp_value" min="0.0" max="1.0" step="0.1">
                        <span>Creative</span>
                        <span id="translate_temp_value" class="slider-value-display"></span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="rephrasePrompt">Rephrase Prompt</label>
                <textarea id="rephrasePrompt" rows="5"></textarea>
                <div class="temperature-control-group">
                    <label for="rephrase_temp_slider">Rephrase Temperature</label>
                    <div class="slider-container">
                        <span>Factual</span>
                        <input type="range" id="rephrase_temp_slider" class="prompt-temp-slider" data-target="rephrase_temp_value" min="0.0" max="1.0" step="0.1">
                        <span>Creative</span>
                        <span id="rephrase_temp_value" class="slider-value-display"></span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="rephraseLanguages">Rephrase Languages</label>
                <input type="text" id="rephraseLanguages" placeholder="e.g., English, Indonesian, Japanese">
                <p class="form-hint">Define the target languages for the rephrase feature, separated by commas.</p>
            </div>
        </fieldset>

        <div class="form-actions">
            <button id="savePromptsButton" class="button button-primary">Save Prompts</button>
        </div>
      </section>

      <section id="history" class="content-pane">
        <div class="pane-header">
            <div class="pane-header-content">
                <h1>Interaction History</h1>
                <p class="section-description">Review all your past interactions with the extension.</p>
            </div>
            <div class="pane-header-actions">
                <button id="exportHistoryButton" class="button button-secondary">Export</button>
                <button id="clearHistoryButton" class="button button-danger">Clear All</button>
            </div>
        </div>
        <div id="history-list-container"></div>
      </section>

      <section id="data" class="content-pane">
        <h1>Data Management</h1>
        <p class="section-description">Manage your extension's stored data.</p>
        <fieldset>
            <legend>Advanced</legend>
            <div class="form-group">
              <label>Reset Settings</label>
              <p class="form-hint">Reset all extension settings, including API key and custom prompts, to their default values. This action cannot be undone.</p>
              <div class="form-actions" style="justify-content: flex-start; margin-top: 10px;">
                  <button id="resetSettingsButton" class="button button-danger">Reset All Settings</button>
              </div>
            </div>
        </fieldset>
      </section>
    </main>
  </div>

  <div id="notification-container"></div>
  <script src="../js/vendor/dompurify.min.js"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/vendor/marked.min.js"></script>
  <script src="../js/prompts.js"></script>
  <script src="../js/options.js"></script>
</body>
</html>