<!-- === Hafizh Signature Code ===
Author: Hafizh Rizqullah ‚Äî GeminiAnswerBot Specialist
File: ui/options.html
Created: 2025-08-27 12:05:00 -->

<!DOCTYPE html>
<html>
<head>
  <title>GeminiAnswerBot - Settings</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../assets/options.css">
</head>
<body>
  <div class="settings-container">
    <nav class="settings-sidebar">
      <ul>
        <li>
          <a href="#general" class="active">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg></span>
            General
          </a>
        </li>
        <li>
          <a href="#prompts">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg></span>
            Prompts
          </a>
        </li>
        <li>
          <a href="#history">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 4v6h6"></path><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg></span>
            History
          </a>
        </li>
        <li>
          <a href="#data">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg></span>
            Data
          </a>
        </li>
      </ul>
    </nav>

    <main class="settings-content">
      <!-- General Settings Pane -->
      <div id="general" class="content-pane">
        <div class="pane-header-main">
          <h1>General Settings</h1>
          <p class="section-description">Configure your API key, select the AI model, and adjust core extension behaviors.</p>
        </div>
        
        <div id="syncWarning" class="settings-card hidden" style="border-color: var(--accent-yellow); background-color: rgba(255, 204, 0, 0.1);">
            <div class="card-content" style="padding: 16px 20px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--accent-yellow); flex-shrink: 0;"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                    <div>
                        <h3 style="margin: 0 0 4px 0; font-size: 16px;">Sync Unavailable</h3>
                        <p class="form-hint" style="margin:0;">Your browser settings are preventing sync. Settings are saved locally to this device only.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="settings-card">
          <div class="card-content">
            <div class="form-row">
              <label for="apiKey" class="form-row-label-static">Google Gemini API Key</label>
              <div class="form-row-control">
                <div class="input-wrapper">
                  <input type="password" id="apiKey" placeholder="Enter your API key">
                  <span id="revealApiKey" class="reveal-icon" title="Show/Hide API Key">
                    <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    <svg class="icon-eye-slash hidden" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                  </span>
                </div>
              </div>
            </div>
            <div class="form-row">
              <label for="modelSelect" class="form-row-label-static">AI Model</label>
              <div class="form-row-control">
                <select id="modelSelect">
                  <option value="gemini-2.5-pro">Gemini 2.5 Pro (Recommended)</option>
                  <option value="gemini-flash-latest">Gemini Flash Latest</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <p class="settings-group-description">Controls randomness. Lower is more deterministic, higher is more creative.</p>
        <div class="settings-card">
            <div class="card-content">
                <div class="form-row">
                    <label for="temperatureSlider" class="form-row-label-static">Global Temperature</label>
                    <div class="form-row-control">
                        <div class="slider-container">
                            <span id="temperatureValue" class="slider-value-display">0.4</span>
                            <input type="range" id="temperatureSlider" min="0" max="1" step="0.1" value="0.4">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <p class="settings-group-description">Customize the core functionality of the extension during quiz analysis.</p>
        <div class="settings-card">
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label-stacked">
                <label for="autoHighlightToggle">Auto-Highlight Answer</label>
                <p class="form-hint">Automatically highlight the AI's answer on the page.</p>
              </div>
              <div class="form-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="autoHighlightToggle" checked>
                  <span class="slider"></span>
                </label>
              </div>
            </div>
            <div class="form-row">
              <div class="form-row-label-stacked">
                <label for="preSubmissionCheckToggle">Pre-Submission Check</label>
                <p class="form-hint">Warn if your selected answer differs from the AI's.</p>
              </div>
              <div class="form-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="preSubmissionCheckToggle" checked>
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button id="testButton" class="button button-secondary">Test Connection</button>
          <button id="saveGeneralButton" class="button button-primary">Save General Settings</button>
        </div>
      </div>

      <!-- Prompts Settings Pane -->
      <div id="prompts" class="content-pane">
        <div class="pane-header-main">
          <h1>Prompt Engineering</h1>
          <p class="section-description">Customize the system prompts used by the AI to tailor its behavior and responses.</p>
        </div>
        
        <div class="settings-card">
          <div class="card-content">
            <div class="form-row">
              <label for="profileSelect" class="form-row-label-static">Active Prompt Profile</label>
              <div class="form-row-control">
                <div class="profile-manager">
                  <select id="profileSelect"></select>
                  <div class="profile-actions">
                    <button id="newProfileBtn" class="button button-icon" title="New Profile">+</button>
                    <button id="renameProfileBtn" class="button button-icon" title="Rename Profile">‚úèÔ∏è</button>
                    <button id="deleteProfileBtn" class="button button-icon" title="Delete Profile">üóëÔ∏è</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <div class="card-header"><h2>Core Prompts</h2></div>
          <div class="card-content">
            <div class="form-group">
              <div class="form-group-header">
                <label for="answerPrompt">Quiz Answering</label>
                <button class="prompt-reset-btn" data-prompt-key="answer" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="answerPrompt" rows="6"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span id="answer_temp_value" class="slider-value-display">0.4</span>
                  <input type="range" id="answer_temp_slider" data-target="answer_temp_value" min="0" max="1" step="0.1">
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group-header">
                <label for="explanationPrompt">Explanation</label>
                <button class="prompt-reset-btn" data-prompt-key="explanation" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="explanationPrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span id="explanation_temp_value" class="slider-value-display">0.4</span>
                  <input type="range" id="explanation_temp_slider" data-target="explanation_temp_value" min="0" max="1" step="0.1">
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <div class="card-header"><h2>Context Menu Prompts</h2></div>
          <div class="card-content">
            <div class="form-group">
              <div class="form-group-header">
                <label for="summarizePrompt">Summarize</label>
                <button class="prompt-reset-btn" data-prompt-key="summarize" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="summarizePrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span id="summarize_temp_value" class="slider-value-display">0.4</span>
                  <input type="range" id="summarize_temp_slider" data-target="summarize_temp_value" min="0" max="1" step="0.1">
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group-header">
                <label for="translatePrompt">Translate</label>
                <button class="prompt-reset-btn" data-prompt-key="translate" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="translatePrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span id="translate_temp_value" class="slider-value-display">0.4</span>
                  <input type="range" id="translate_temp_slider" data-target="translate_temp_value" min="0" max="1" step="0.1">
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group-header">
                <label for="rephrasePrompt">Rephrase</label>
                <button class="prompt-reset-btn" data-prompt-key="rephrase" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="rephrasePrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span id="rephrase_temp_value" class="slider-value-display">0.4</span>
                  <input type="range" id="rephrase_temp_slider" data-target="rephrase_temp_value" min="0" max="1" step="0.1">
                </div>
              </div>
            </div>
            <div class="form-group">
                <div class="form-group-header">
                    <label for="rephraseLanguages">Rephrase Languages</label>
                </div>
                <input type="text" id="rephraseLanguages" placeholder="e.g., English, Indonesian, Spanish">
                <p class="form-hint" style="margin-top: 8px;">Comma-separated list of languages for the 'Rephrase' context menu.</p>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <div class="card-header">
            <h2>Custom Context Menu Actions</h2>
          </div>
          <div class="card-content" style="padding: 20px;">
            <div id="customActionsList">
            </div>
            <button id="addNewActionButton" class="button button-secondary" style="width: 100%; margin-top: 16px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
              Add New Action
            </button>
          </div>
        </div>

        <div class="form-actions">
          <button id="savePromptsButton" class="button button-primary">Save Prompts</button>
        </div>
      </div>

      <!-- History Pane -->
      <div id="history" class="content-pane">
        <div class="pane-header-main">
          <h1>Interaction History</h1>
          <p class="section-description">Review your past 100 interactions with the extension.</p>
        </div>
        <div class="pane-header-actions">
          <button id="exportHistoryButton" class="button button-secondary">Export History</button>
          <button id="clearHistoryButton" class="button button-danger">Clear History</button>
        </div>
        <div id="history-list-container">
        </div>
      </div>

      <!-- Data Management Pane -->
      <div id="data" class="content-pane">
        <div class="pane-header-main">
          <h1>Data Management</h1>
          <p class="section-description">Manage extension data stored on your local machine.</p>
        </div>

        <!-- **NEW**: Permissions & Privacy Card -->
        <p class="settings-group-description">Control how the extension interacts with web pages.</p>
        <div class="settings-card">
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label-stacked">
                <label for="fullAccessToggle">Enable Full-Page Access</label>
                <p class="form-hint">
                  Required for context menus to work on all pages without first opening the popup. 
                  When disabled, the extension only accesses the active tab when you open the popup. 
                  This extension does not collect any data.
                </p>
              </div>
              <div class="form-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="fullAccessToggle">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <p class="settings-group-description">For troubleshooting and development purposes.</p>
        <div class="settings-card">
            <div class="card-content">
                <div class="form-row">
                    <div class="form-row-label-stacked">
                        <label for="debugModeToggle">Debug Mode</label>
                        <p class="form-hint">Enable detailed logging to the console for troubleshooting.</p>
                    </div>
                    <div class="form-row-control">
                        <label class="toggle-switch">
                            <input type="checkbox" id="debugModeToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <p class="settings-group-description">These actions are permanent and cannot be undone.</p>
        <div class="settings-card">
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label-stacked">
                <label>Reset All Settings</label>
                <p class="form-hint">This will permanently delete your API key, custom prompts, and all history.</p>
              </div>
              <div class="form-row-control">
                <button id="resetSettingsButton" class="button button-danger">Reset to Factory Defaults</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <div id="customActionModal" class="modal-overlay hidden">
    <div class="modal-box">
      <h2 id="customActionModalTitle">Add New Action</h2>
      <form id="customActionForm">
        <input type="hidden" id="customActionId">
        <div class="modal-form-group">
          <label for="customActionName">Action Name</label>
          <input type="text" id="customActionName" placeholder="e.g., Summarize in 5 Bullets" required>
          <p class="form-hint">This name will appear in the right-click context menu.</p>
        </div>
        <div class="modal-form-group">
          <label for="customActionPrompt">Custom Prompt</label>
          <textarea id="customActionPrompt" rows="8" placeholder="e.g., Summarize the following text into a concise, five-point bullet list..." required></textarea>
          <p class="form-hint">The selected text will be appended to this prompt.</p>
        </div>
        <div class="modal-actions">
          <button type="button" id="customActionCancel" class="button button-secondary">Cancel</button>
          <button type="submit" id="customActionSave" class="button button-primary">Save Action</button>
        </div>
      </form>
    </div>
  </div>

  <div id="custom-confirm-overlay" class="hidden">
    <div class="custom-confirm-box">
      <h2 id="custom-confirm-title">Confirm Action</h2>
      <p id="custom-confirm-message">Are you sure?</p>
      <div class="custom-confirm-actions">
        <button id="custom-confirm-cancel" class="button button-secondary">Cancel</button>
        <button id="custom-confirm-ok" class="button button-primary">OK</button>
      </div>
    </div>
  </div>

  <div id="notification-container"></div>
  
  <script src="../js/vendor/dompurify.min.js"></script>
  <script src="../js/utils/helpers.js"></script>
  <script src="../js/utils/errorHandler.js"></script>
  <script src="../js/utils/storage.js"></script>
  <script src="../js/vendor/marked.min.js"></script>
  <script src="../js/prompts.js"></script>
  
  <script src="../js/options/ui.js"></script>
  <script src="../js/options/nav.js"></script>
  <script src="../js/options/history.js"></script>
  <script src="../js/options/settings.js"></script>
  <script src="../js/options.js"></script>
</body>
</html>