<!-- // === Hafizh Rizqullah | GeminiAnswerBot ===
// üîí Created by Hafizh Rizqullah || Refine by AI Assistant
// üìÑ ui/options.html
// üïì Created: 2024-05-22 19:15:00
// üß† Modular | DRY | SOLID | Apple HIG Compliant -->

<!DOCTYPE html>
<html>
<head>
  <title>GeminiAnswerBot - Settings</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../assets/options.css">
</head>
<body>
  <div class="settings-container">
    <nav class="settings-sidebar">
      <ul>
        <li>
          <a href="#general" class="active">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg></span>
            General
          </a>
        </li>
        <li>
          <a href="#prompts">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg></span>
            Prompts
          </a>
        </li>
        <li>
          <a href="#history">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 4v6h6"></path><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg></span>
            History
          </a>
        </li>
        <li>
          <a href="#data">
            <span class="sidebar-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg></span>
            Data
          </a>
        </li>
      </ul>
    </nav>

    <main class="settings-content">
      <!-- General Settings Pane -->
      <div id="general" class="content-pane">
        <h1>General Settings</h1>
        <p class="section-description">Configure your API key, select the AI model, and adjust core extension behaviors.</p>
        
        <div class="settings-card">
          <div class="card-header"><h2>API Configuration</h2></div>
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label">
                <label for="apiKey">Google Gemini API Key</label>
                <p class="form-hint">Your key is stored locally and never shared.</p>
              </div>
              <div class="form-row-control">
                <div class="input-wrapper">
                  <input type="password" id="apiKey" placeholder="Enter your API key">
                  <span id="revealApiKey" class="reveal-icon" title="Show/Hide API Key">
                    <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    <svg class="icon-eye-slash hidden" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                  </span>
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-row-label">
                <label for="modelSelect">AI Model</label>
                <p class="form-hint">Select the Gemini model for processing requests.</p>
              </div>
              <div class="form-row-control">
                <select id="modelSelect">
                  <option value="gemini-1.5-pro-latest">Gemini 1.5 Pro (Recommended)</option>
                  <option value="gemini-1.5-flash-latest">Gemini 1.5 Flash</option>
                  <option value="gemini-pro">Gemini Pro</option>
                </select>
              </div>
            </div>
            <div class="form-row">
                <div class="form-row-label">
                    <label for="temperatureSlider">Global Temperature</label>
                    <p class="form-hint">Controls randomness. Lower is more deterministic, higher is more creative.</p>
                </div>
                <div class="form-row-control">
                    <div class="slider-container">
                        <span>0.0</span>
                        <input type="range" id="temperatureSlider" min="0" max="1" step="0.1" value="0.4">
                        <span>1.0</span>
                        <span id="temperatureValue" class="slider-value-display">0.4</span>
                    </div>
                </div>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <div class="card-header"><h2>Behavior</h2></div>
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label">
                <label for="autoHighlightToggle">Auto-Highlight Answer</label>
                <p class="form-hint">Automatically highlight the AI's answer on the page.</p>
              </div>
              <div class="form-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="autoHighlightToggle" checked>
                  <span class="slider"></span>
                </label>
              </div>
            </div>
            <div class="form-row">
              <div class="form-row-label">
                <label for="preSubmissionCheckToggle">Pre-Submission Check</label>
                <p class="form-hint">Warn if your selected answer differs from the AI's.</p>
              </div>
              <div class="form-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="preSubmissionCheckToggle" checked>
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button id="testButton" class="button button-secondary">Test Connection</button>
          <button id="saveGeneralButton" class="button button-primary">Save General Settings</button>
        </div>
      </div>

      <!-- Prompts Settings Pane -->
      <div id="prompts" class="content-pane">
        <h1>Prompt Engineering</h1>
        <p class="section-description">Customize the system prompts used by the AI to tailor its behavior and responses.</p>
        
        <div class="settings-card">
          <div class="card-header"><h2>Profile Management</h2></div>
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label">
                <label for="profileSelect">Active Prompt Profile</label>
                <p class="form-hint">Select a profile to edit its prompts below.</p>
              </div>
              <div class="form-row-control">
                <div class="profile-manager">
                  <select id="profileSelect"></select>
                  <div class="profile-actions">
                    <button id="newProfileBtn" class="button button-secondary" title="New Profile">+</button>
                    <button id="renameProfileBtn" class="button button-secondary" title="Rename Profile">‚úèÔ∏è</button>
                    <button id="deleteProfileBtn" class="button button-secondary" title="Delete Profile">üóëÔ∏è</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <div class="card-header"><h2>Core Prompts</h2></div>
          <div class="card-content">
            <div class="form-group">
              <div class="form-group-header">
                <label for="answerPrompt">Quiz Answering</label>
                <button class="prompt-reset-btn" data-prompt-key="answer" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="answerPrompt" rows="6"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span>0.0</span>
                  <input type="range" id="answer_temp_slider" data-target="answer_temp_value" min="0" max="1" step="0.1">
                  <span>1.0</span>
                  <span id="answer_temp_value" class="slider-value-display">0.4</span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group-header">
                <label for="explanationPrompt">Explanation</label>
                <button class="prompt-reset-btn" data-prompt-key="explanation" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="explanationPrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span>0.0</span>
                  <input type="range" id="explanation_temp_slider" data-target="explanation_temp_value" min="0" max="1" step="0.1">
                  <span>1.0</span>
                  <span id="explanation_temp_value" class="slider-value-display">0.4</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <div class="card-header"><h2>Context Menu Prompts</h2></div>
          <div class="card-content">
            <div class="form-group">
              <div class="form-group-header">
                <label for="summarizePrompt">Summarize</label>
                <button class="prompt-reset-btn" data-prompt-key="summarize" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="summarizePrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span>0.0</span>
                  <input type="range" id="summarize_temp_slider" data-target="summarize_temp_value" min="0" max="1" step="0.1">
                  <span>1.0</span>
                  <span id="summarize_temp_value" class="slider-value-display">0.4</span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group-header">
                <label for="translatePrompt">Translate</label>
                <button class="prompt-reset-btn" data-prompt-key="translate" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="translatePrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span>0.0</span>
                  <input type="range" id="translate_temp_slider" data-target="translate_temp_value" min="0" max="1" step="0.1">
                  <span>1.0</span>
                  <span id="translate_temp_value" class="slider-value-display">0.4</span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group-header">
                <label for="rephrasePrompt">Rephrase</label>
                <button class="prompt-reset-btn" data-prompt-key="rephrase" title="Reset to default"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 3.5 7.1L2 9.5"/><path d="M2 12.5a10 10 0 0 0 18.5 4.4l1.5-2.4"/></svg></button>
              </div>
              <textarea id="rephrasePrompt" rows="4"></textarea>
              <div class="temperature-control-group">
                <label>Temperature Override</label>
                <div class="slider-container">
                  <span>0.0</span>
                  <input type="range" id="rephrase_temp_slider" data-target="rephrase_temp_value" min="0" max="1" step="0.1">
                  <span>1.0</span>
                  <span id="rephrase_temp_value" class="slider-value-display">0.4</span>
                </div>
              </div>
            </div>
            <div class="form-group">
                <div class="form-group-header">
                    <label for="rephraseLanguages">Rephrase Languages</label>
                </div>
                <input type="text" id="rephraseLanguages" placeholder="e.g., English, Indonesian, Spanish">
                <p class="form-hint" style="margin-top: 8px;">Comma-separated list of languages for the 'Rephrase' context menu.</p>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button id="savePromptsButton" class="button button-primary">Save Prompts</button>
        </div>
      </div>

      <!-- History Pane -->
      <div id="history" class="content-pane">
        <div class="pane-header">
          <div>
            <h1>Interaction History</h1>
            <p class="section-description">Review your past 100 interactions with the extension.</p>
          </div>
          <div class="pane-header-actions">
            <button id="exportHistoryButton" class="button button-secondary">Export History</button>
            <button id="clearHistoryButton" class="button button-danger">Clear History</button>
          </div>
        </div>
        <div id="history-list-container">
          <!-- History items will be loaded here by history.js -->
        </div>
      </div>

      <!-- Data Management Pane -->
      <div id="data" class="content-pane">
        <h1>Data Management</h1>
        <p class="section-description">Manage extension data stored on your local machine.</p>
        <div class="settings-card">
          <div class="card-header"><h2>Danger Zone</h2></div>
          <div class="card-content">
            <div class="form-row">
              <div class="form-row-label">
                <label>Reset All Settings</label>
                <p class="form-hint">This will permanently delete your API key, custom prompts, and all history. This action cannot be undone.</p>
              </div>
              <div class="form-row-control">
                <button id="resetSettingsButton" class="button button-danger">Reset to Factory Defaults</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <div id="custom-confirm-overlay" class="hidden">
    <div class="custom-confirm-box">
      <h2 id="custom-confirm-title">Confirm Action</h2>
      <p id="custom-confirm-message">Are you sure?</p>
      <div class="custom-confirm-actions">
        <button id="custom-confirm-cancel" class="button button-secondary">Cancel</button>
        <button id="custom-confirm-ok" class="button button-primary">OK</button>
      </div>
    </div>
  </div>

  <div id="notification-container"></div>
  
  <!-- SCRIPT LOADING ORDER IS CRITICAL -->
  <script src="../js/vendor/dompurify.min.js"></script>
  <script src="../js/utils/helpers.js"></script>
  <script src="../js/utils/errorHandler.js"></script>
  <script src="../js/vendor/marked.min.js"></script>
  <script src="../js/prompts.js"></script>
  
  <!-- MODULAR OPTIONS SCRIPTS -->
  <script src="../js/options/ui.js"></script>
  <script src="../js/options/nav.js"></script>
  <script src="../js/options/history.js"></script>
  <script src="../js/options/settings.js"></script>

  <!-- MAIN ORCHESTRATOR SCRIPT (must be last) -->
  <script src="../js/options.js"></script>
</body>
</html>